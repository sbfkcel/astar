/*! Project:astar, Create:FWS 2019.10.29 15:21, Update:FWS 2021.09.19 16:10 */ 
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"function"==typeof define&&(define.cmd||define.hjs)?define(function(require,exports,t){t.exports=e()}):t.Astar=e()}(this,function(){"use strict";var t=function(t){return t.split(",").map(Number)};return function(){function e(t){var e=this;e.grid=t,e.openList=new Map,e.closeList=new Map,e.current}return e.prototype.search=function(t,e,n){var r=this,i={rightAngle:!1,optimalResult:!0},o=t.toString();n=r.searchOption=n||{};for(var s in i)n[s]===undefined&&(n[s]=i[s]);r.start=t,r.end=e,r.grid.get(t).value=0,r.grid.set(t,"type","start"),r.grid.get(e).value=0,r.grid.set(e,"type","end"),r.openList.set(o,null),r.grid.set(t,"type","open");var u,g,p=!0;for((g=function(t){if(r.grid.set(t,"type","highlight"),r.grid.get(t)===r.grid.get(r.end))p=!1,u=r.getBackPath(t);else{for(var e=r.getAround(t),n=0,i=e.length;n<i;n++){var o=e[n],s=o.toString(),g=r.grid.get(o);if(null!==r.openList.get(s))r.openList.set(s,null),g.parent=t,g.g=r.g(o,t),g.h=r.h(o,r.end),g.f=r.f(o),r.grid.set(o,"type","open");else{var f=g.g,a=r.g(o,t);a<f&&(g.parent=t,g.g=a,g.f=r.f(o),r.grid.set(o,"type","update"))}}var d=t.toString();r.openList["delete"](d),r.closeList.set(d,null),r.grid.set(t,"type","close")}})(t);p;){var f=r.getOpenListMin();f?g(f.key):p=!1}return u},e.prototype.getBackPath=function(t){for(var e=this,n=[t],r=!0;r;)t=e.grid.get(t).parent,t?n.unshift(t):r=!1;return n},e.prototype.getOpenListMin=function(){for(var e,n=this,r=0,i=n.openList;r<i.length;r++){var o=i[r],s=t(o[0]),u=n.grid.get(s);(e===undefined||u.f<e.f)&&(e=n.grid.get(s))}return e},e.prototype.getOffsetGrid=function(t,e){return[t[0]+e[0],t[1]+e[1]]},e.prototype.getAround=function(t){var e=this,n=e.searchOption,r=[],i=e.grid,o=[-1,-1],s=[0,-1],u=[1,-1],g=[1,0],p=[1,1],f=[0,1],a=[-1,1],d=[-1,0],h=[],l=function(t,n){var r=i.get(e.getOffsetGrid(t,n));return r!==undefined&&0===r.value};if(h.push(s),h.push(g),h.push(f),h.push(d),!n.rightAngle){var c=l(t,d),v=l(t,g),y=l(t,s),L=l(t,f);(c||y)&&h.push(o),(c||L)&&h.push(a),(v||y)&&h.push(u),(v||L)&&h.push(p)}for(var m=0,O=h.length;m<O;m++){var M=h[m],A=[t[0]+M[0],t[1]+M[1]],b=A.toString(),S=null===e.closeList.get(b);A[0]>-1&&A[0]<i.col&&A[1]>-1&&A[1]<i.row&&!S&&i.get(A).value<1&&r.push(A)}return r},e.prototype.f=function(t){var e=this,n=e.grid.get(t);return n.g+n.h},e.prototype.g=function(t,e){return this.searchOption.optimalResult?(e[0]===t[0]||e[1]===t[1]?10:14)+this.grid.get(e).g:0},e.prototype.h=function(t,e){return 10*(Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1]))},e}()});